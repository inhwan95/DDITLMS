<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorator="~{layout/layout}">
<th:block layout:fragment="content">
    <th:block th:replace="/fragment/page-header.html :: page-headerFragment(title='전자결재')"></th:block>
    <!-- Container-fluid starts-->
    <div class="container-fluid">
        <div class="row">
            <div class="col-xl-2 box-col-2 pe-0">
                <div class="job-sidebar"><a class="btn btn-primary job-toggle" href="javascript:void(0)">file filter</a>
                    <div class="job-left-aside custom-scrollbar">
                        <div class="file-sidebar">
                            <div class="card">
                                <div class="card-body">
                                    <ul>
                                        <li>
                                            <a class="btn btn-light" href="/drafting">기안하기</a>
                                        </li>
                                        <li>
                                            <a class="btn btn-light" href="/sanctn">결재처리</a>
                                        </li>
                                        <li>
                                            <a class="btn btn-light" href="/sanctn">공람처리</a>
                                        </li>
                                    </ul>
                                    <hr>

                                    <div class="card-body dropdown-basic">
                                        <div class="dropdown">
                                            <div class="btn-group mb-0">
                                                <button class="dropbtn btn-success btn-round" type="button">결재조회
                                                    <span><i class="icofont icofont-arrow-down"></i></span></button>
                                                <div class="dropdown-content"><a href="#">승인완료</a><a href="#">진행중</a><a
                                                        href="#">반려</a></div>
                                            </div>
                                        </div>
                                    </div>
                                    <hr>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl-7 col-md-7 box-col-7">
                <div class="file-content">
                    <div class="card" style="text-align: center; margin: 0 auto;">
                        <div class="card-header center-block style=width:300px; padding:15px;">
                            <ul style='display:inline-block'>
                                <li style='display:inline-block'><i class="fa fa-briefcase fa-5x p-2">진행</i><br><div style="text-align: center; margin: 0 auto;"><span
                                        th:text="|총 : ${totalPro} 건|">총 0건</span></div>
                                </li>
                                <li style='display:inline-block'><i class="fa fa-arrow-left fa-5x p-2">반려</i><br><div style="text-align: center; margin: 0 auto;"><span
                                        th:text="|총 : ${totalRej} 건|">총 3건</span></div>
                                </li>
                                <li style='display:inline-block'><i class="fa fa-repeat fa-5x p-2">공람</i><br><div style="text-align: center; margin: 0 auto;"><span
                                        th:text="|총 : ${totalPub} 건|">총 3건</span></div>
                                </li>
                            </ul>
                        </div>
                        <hr>
                        <div class="select-button">
                            <button class="btn btn-square btn-outline-success btn-lg" type="button"
                                    data-bs-original-title="" id="btnPro" >진행중
                            </button>
                            <button class="btn btn-square btn-outline-success btn-lg" type="button"
                                    data-bs-original-title="" id="btnReject">반려
                            </button>
                            <button class="btn btn-square btn-outline-success btn-lg" type="button"
                                    data-bs-original-title="" id="btnPublic">공람
                            </button>
                            <hr>
                        </div>
                        <div class="table-responsive">
                            <table class="table table-border-horizontal">
                                <thead>
                                    <tr>
                                        <th scope="col">결재단계</th>
                                        <th scope="col">결재제목</th>
                                        <th scope="col">기안자</th>
                                        <th scope="col">상태</th>
                                        <th scope="col">결재기한</th>
                                    </tr>
                                </thead>
                                <tbody id="test">
                                <tr th:each="proDetail : ${proDetails}" style="cursor:pointer;" th:onclick="'location.href=\''+ @{showSanctn/{id}(id=${proDetail.sanctnSn.sanctnId})} + '\''">
                                    <td th:text="${proDetail.sanctnStep}">결재단계</td>
                                    <td th:text="${proDetail.sanctnSn.sanctnSj}">결재명</td>
                                    <td th:text="${proDetail.mberNo.name}">기안자</td>
                                    <td th:text="${proDetail.sanctnSn.status.krName}">상태</td>
                                    <td th:text="${proDetail.sanctnSn.sanctnUpdde}">기한</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl-3 box-col-3 pe-0">
                <div class="file-content">
                    <div class="card">
                        <div class="text-center">
                            최근결재의견
                        </div>
                        <div class="card-body">
                            <div class="card-block row">
                                <div class="col-sm-12 col-lg-12 col-xl-12">
                                    <div class="table-responsive">
                                        <table class="table">
                                            <thead>
                                            <tr>
                                                <th scope="col">홍길동 ∘ 교무처</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr>
                                                <th scope="row" class="table-primary">첨부파일이 빠져 있네요</th>
                                            </tr>
                                            </tbody>
                                        </table>
                                        <table class="table">
                                            <thead>
                                            <tr>
                                                <th scope="col">홍길동 ∘ 교무처</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr>
                                                <th scope="row" class="table-primary">첨부파일이 빠져 있네요222</th>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Container-fluid Ends-->
    <script>

        const btnPro = document.querySelector("#btnPro");

        btnPro.addEventListener("click", function () {
        $.ajax({
                type: "GET",
                url: "/sanctnProgress",
                }).done(function (fragment) {
                    $("#test").replaceWith(fragment);
                });
        })

        const btnReject = document.querySelector("#btnReject");

        btnReject.addEventListener("click", function () {

        $.ajax({
                type: "GET",
                url: "/sanctnReject",
                }).done(function (fragment) {
                    $("#test").replaceWith(fragment);
                });
        })


        const btnPublic = document.querySelector("#btnPublic");

        btnPublic.addEventListener("click", function () {

        $.ajax({
                type: "GET",
                url: "/sanctnPublic",
                }).done(function (fragment) {
                    $("#test").replaceWith(fragment);
                });
        })







    </script>
</th:block>
</html>